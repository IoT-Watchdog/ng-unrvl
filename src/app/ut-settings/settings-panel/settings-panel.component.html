<h1>Global Settings</h1>
<div class="settingspage">
  <section *ngIf="globalSettingsService.server.type == 'Tricorder'">
    <h2>
      Screen Brightness:
      <span *ngIf="!bn.disabled"
        >{{ (currentBrightness / 255) * 100 | number: '1.0-0' }}&#8239;%</span
      >
    </h2>
    <app-display-brighness
      (brightnessEvent)="setNewBN($event)"
      #bn
    ></app-display-brighness>
  </section>

  <section>
    <a (click)="fullscreen()">Fullscreen</a>
  </section>

  <section
    class="center"
    *ngIf="globalSettingsService.server.type == 'Tricorder'"
  >
    <button (click)="halt()">Halt</button>
    <button (click)="reboot()">Reboot</button>
  </section>

  <section *ngFor="let settingsSection of (globalSettingsUnsaved | keyvalue)">
    <h2>{{ settingsSection.value.settingAttributes.title }}</h2>
    <section *ngFor="let entry of (settingsSection.value.settings | keyvalue)">
      <div class="fields">
        <label for="{{ settingsSection.key }}-{{ entry.key }}"
          >{{ entry.value.fieldName }}:
        </label>
        <input
          type="text"
          class="form-control"
          id="{{ settingsSection.key }}-{{ entry.key }}"
          [(ngModel)]="entry.value.fieldValue"
        />
      </div>
      <div class="valuedebug" *ngIf="debug == true">
        <!-- '{{ entry.value.fieldValue }}',-->
        <!--
        <span *ngIf="entry.key == 'serverHostName'"
          ><a href="http://{{ entry.value.fieldValue }}">{{
            entry.value.fieldValue
          }}</a></span
        > -->
        Default: '{{
          defaultSettings[settingsSection.key].settings[entry.key].fieldValue
        }}',<br />
        Global: '<span
          *ngIf="
            globalSettings &&
            globalSettings[settingsSection.key] &&
            globalSettings[settingsSection.key]['settings'] &&
            globalSettings[settingsSection.key]['settings'][entry.key] &&
            globalSettings[settingsSection.key]['settings'][entry.key][
              'fieldValue'
            ]
          "
          >{{
            globalSettings[settingsSection.key].settings[entry.key].fieldValue
          }}</span
        >'
      </div>
    </section>
    <section id="submit" class="center">
      <div>
        <!-- div needed for text-align center -->
        <button type="submit" class="btn btn-success" (click)="save()">
          Save
        </button>
        <button type="submit" class="btn btn-success" (click)="load()">
          Load
        </button>
        <button type="submit" class="btn btn-success" (click)="reset()">
          Reset
        </button>
      </div>
    </section>
  </section>

  <section id="links">
    <a
      *ngIf="globalSettingsService.server.type == 'Tricorder'"
      href="{{ oldIFPath }}"
      >Old Interface</a
    >
    <a href="{{ prometheusPath }}">Prometheus Admin Interface</a>
  </section>
</div>
